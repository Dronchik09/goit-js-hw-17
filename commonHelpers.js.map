{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport const refs = {\n  searchForm: document.querySelector('.js-search-form'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.js-loader'),\n  loadmore: document.querySelector('.loadmore-button'),\n};\n\nconst galleryBigImage = new SimpleLightbox('.gallery a', {\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n  scrollZoom: false,\n});\n\ngalleryBigImage.on('show.simplelightbox', function () {});\n\niziToast.settings({\n  timeout: 2500,\n  resetOnHover: true,\n  transitionIn: 'flipInX',\n  transitionOut: 'flipOutX',\n  position: 'topRight',\n  titleSize: 25,\n  messageSize: 25,\n  backgroundColor: 'rgba(255, 182, 66, 0.8)',\n});\n\nfunction renderCard(imageData) {\n  return imageData\n    .map(\n      el =>\n        `<li class=\"card\">\n            <a href=\"${el.largeImageURL}\" class=\"big gallery-link\">\n              <img\n                src=\"${el.previewURL}\"\n                alt=\"${el.tags}\"\n                title=\"${el.tags}\"\n                class=\"card-img\"\n            /></a>\n            <ul class=\"card-title\">\n              <li class=\"card-text-blok\">\n                <h2 class=\"card-title-text\">Likes</h2>\n                <p class=\"card-text-value\">${el.likes}</p>\n              </li>\n              <li class=\"card-text-blok\">\n                <h2 class=\"card-title-text\">Views</h2>\n                <p class=\"card-text-value\">${el.views}</p>\n              </li>\n              <li class=\"card-text-blok\">\n                <h2 class=\"card-title-text\">Comments</h2>\n                <p class=\"card-text-value\">${el.comments}</p>\n              </li>\n              <li class=\"card-text-blok\">\n                <h2 class=\"card-title-text\">Downloads</h2>\n                <p class=\"card-text-value\">${el.downloads}</p>\n              </li>\n            </ul>\n          </li>`\n    )\n    .join('');\n}\n\nlet errorMessageShown = false;\n\nexport function handlerError(error) {\n  if (!errorMessageShown) {\n    refs.loader.classList.remove('loader');\n    switch (error) {\n      case 'outdata':\n        iziToast.warning({\n          title: 'Error',\n          message: 'Введіть данні для пошуку!',\n        });\n        break;\n      case 'nodata':\n        iziToast.warning({\n          title: 'Error',\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n        });\n        break;\n      default:\n        iziToast.error({\n          title: 'Error',\n          message: \"We're sorry, but you've reached the end of search results.\",\n        });\n        break;\n    }\n    errorMessageShown = true;\n  }\n}\n\nexport function scrollCard() {\n  const heightImageCard = document\n    .querySelector('.card')\n    .getBoundingClientRect().height;\n\n  window.scrollBy({\n    left: 0,\n    top: Math.ceil(heightImageCard * 2),\n    behavior: 'smooth',\n  });\n}\n\nexport function addImage(image) {\n  refs.loader.classList.remove('loader');\n  refs.gallery.insertAdjacentHTML('beforeend', renderCard(image));\n  galleryBigImage.refresh();\n}","import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api';\n\nexport const searchSettings = {\n  key: '44850950-a38c775cff20ba6a666909e04',\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: 15,\n  page: 1,\n};\n\nexport async function fetchImage() {\n  const response = await axios.get('/', { params: searchSettings });\n  return response.data;\n}","import { refs, handlerError, scrollCard, addImage } from './js/render-functions';\nimport { fetchImage, searchSettings } from './js/pixabay-api';\n\nrefs.searchForm.addEventListener('submit', handlerSearchButton);\n\nlet currentPage;\nlet totalPage;\n\nfunction handlerSearchButton(event) {\n  event.preventDefault();\n  currentPage = 1;\n  totalPage = 1;\n\n  const searchText = event.target.searchtext.value.trim().toLowerCase();\n\n  if (!searchText) {\n    handlerError('outdata');\n    return;\n  }\n\n  searchSettings.q = searchText;\n  searchSettings.page = currentPage;\n\n  refs.gallery.innerHTML = '';\n  refs.loader.classList.add('loader');\n\n  fetchImage()\n    .then(image => {\n      totalPage = Math.ceil(image.totalHits / searchSettings.per_page);\n\n      if (totalPage === 0) {\n        handlerError('nodata');\n        return;\n      }\n      addImage(image.hits);\n\n      if (totalPage > currentPage) {\n        currentPage += 1;\n        loadMoreImage();\n      }\n    })\n\n    .catch(error => {\n      handlerError(error);\n    })\n    .finally(refs.searchForm.reset());\n}\n\nfunction loadMoreImage() {\n  refs.loadmore.style.setProperty('--lmb-dispay', `block`);\n  refs.loadmore.addEventListener('click', () => {\n    refs.loader.classList.add('loader');\n    searchSettings.page = currentPage;\n    fetchImage()\n      .then(image => {\n        addImage(image.hits);\n        scrollCard();\n        \n        if (totalPage === currentPage) {\n          refs.loadmore.style.setProperty('--lmb-dispay', `none`);\n          iziToast.info({\n            title: 'Info',\n            message: \"We're sorry, but you've reached the end of search results.\",\n          });\n          return;\n        } else {\n          currentPage += 1;\n        }\n      })\n      .catch(error => {\n        handlerError(error);\n      });\n  });\n}"],"names":["refs","galleryBigImage","SimpleLightbox","iziToast","renderCard","imageData","el","errorMessageShown","handlerError","error","scrollCard","heightImageCard","addImage","image","axios","searchSettings","fetchImage","handlerSearchButton","currentPage","totalPage","event","searchText","loadMoreImage"],"mappings":"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"}